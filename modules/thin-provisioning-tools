modules-$(LVM2) += thin-provisioning-tools

thin-provisioning-tools_depends := $(musl_dep)

thin-provisioning-tools_version := git
thin-provisioning-tools_dir := thin-provisioning-tools
thin-provisioning-tools_repo := --recursive https://github.com/jthornber/thin-provisioning-tools.git
thin-provisioning-tools_rev := 8abac422b2165f986a6752cc743724d56f38647c

thin-provisioning-tools_target := \
	$(MAKE_JOBS) \
	$(CROSS_TOOLS) \

thin-provisioning-tools_configure := \
  INSTALL="$(INSTALL)" \
  PKG_CONFIG=/bin/false \
  MODPROBE_CMD=/bin/false \
  ac_cv_func_malloc_0_nonnull=yes \
  ac_cv_func_realloc_0_nonnull=yes \
  ./configure \
  --host i386-elf-linux \
  --prefix "/" \
  --enable-devmapper \
  --disable-selinux \
  --disable-udev-systemd-background-jobs \
  --disable-realtime \
  --disable-dmeventd \
  --disable-lvmetad \
  --disable-lvmpolld \
  --disable-use-lvmlockd \
  --disable-use-lvmetad \
  --disable-use-lvmpolld \
  --disable-blkid_wiping \
  --disable-cmirrord \
  --disable-cache_check_needs_check \
  --with-thin=internal \
  --with-snapshots=internal \
  --disable-thin_check_needs_check \
  --with-cluster=none \

thin-provisioning-tools_target := \
  $(MAKE_JOBS) \
  $(CROSS_TOOLS) \
  DESTDIR="$(INSTALL)" \
  all \
  && \
  $(MAKE) \
  -C "$(build)/$(thin-provisioning-tools_dir)" \
  $(MAKE_JOBS) \
  $(CROSS_TOOLS) \
  DESTDIR="$(INSTALL)" \


 
